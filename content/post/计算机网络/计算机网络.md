---
title: "计算机网络"
date: 2020-06-17T11:22:54+08:00
lastmod: 2020-06-25T22:20:45+08:00
description: ""
draft: false
tags: ["计算机网络"]
categories: ["计算机网络"]
---
# 计算机网络

## 一、概述
### 互联网、因特网和万维网
> **互联网(`internet`)**：凡是由能彼此通信的设备组成的网络就叫互联网，互联网把多种不同的网络连接起来，因此互联网是**网络的网络**

![互联网](https://gitee.com/huanghuang927/picture-host/raw/master/20210928080734.gif)

<div style="text-align: center;">图1 互联网</div>


> **因特网(`Internet`)**：世界范围的计算机网络（`computer network`）

> **万维网(`World Wide Web, WWW`)**：万维网是互联网的主要服务，提供网页和音视频等服务

#### 关系

**互联网（广义）> 因特网 > 万维网**

## 二、因特网

**因特网**包含了全世界数十亿计算设备，在今天，这些设备一般被称为**主机（`host`）** 或者**端系统（`end system`）**，**端系统**通过**通信链路（`communication link`）** 和 **分组交换机（`packet switch`）** 连接到一起。

### ISP
> **因特网服务提供商（Internet Service Provider, ISP）**，ISP 可以从互联网管理机构申请到很多 IP 地址，然后一些机构和个人从某个 ISP 获取 IP 地址的使用权，并可通过该 ISP 连接到互联网

例如中国移动、中国移动、中国电信就是有名的**ISP**

![ISP](https://gitee.com/huanghuang927/picture-host/raw/master/20211018154857.png)


### 协议
> **协议（`protocol`）** 定义了在两个或者多个通信实体之间交换的报文的格式和顺序，以及报文发送和/或接收一条报文或其他事件所采取的动作

### 接入网

![接入网](https://gitee.com/huanghuang927/picture-host/raw/master/20211002115311.png)

<div style="text-align: center;">图2 接入网</div>

## 三、电路交换与分组交换

通过网络链路和交换机移动数据有两种基本方法：**电路交换（`circult switching`）**和**分组交换（`packet switching`）**

### 电路交换（`circuit switching`）

> **电路交换**需要建立一条专用的数据通信路径，这条路径上可能包含许多中间节点。这条通信路径在整个通信过程中将被独占，直到通信结束才会释放资源。**电路交换适合实时性要求较高的大量数据传输的情况。**
>
> 电路交换最显著的特点：**独占资源**，最典型的电路交换：**传统电话网络**

#### 电路交换中的多路复用（`multiplexing`）

> 物理链路的通信能力远远大于一路通信所需要的能力，可以通过**多路复用**提高信道利用率，同时各个通信线路之间又互不影响

* **频分多路复用（`Frequency-Division Multiplexing, FDM`）**
* **时分多路复用（`Time-Division Multiplexing, TDM`）**
* **码分多路复用（`Code-Division Multiplexing, CDM`）**
* **波分多路复用（`Wavelength-Division Multiplexing, WDM`）**

#### 优势

* 通信延时小。通信双方通过专用线路进行通信，数据可以直达。当数据传输量较大时，优点将十分显著
* 线路独占，没有冲突
* 实时性强。一旦通信线路，建立，双方可以实时通信

#### 劣势

* 线路独占，利用率太低
* 连接建立时间过长

### 分组交换（`packet switching`）

#### 分组

在网络应用中，端系统彼此交换**报文（`message`）**。

> 为了从源端系统向目的端系统发送一个报文，源将长报文划分为小的数据块，这些小的数据块被称为分组（`packet`）

在源和目的地之间，每个分组都通过**通信链路（`communication link`）** 和 **分组交换机（`packet switch`）** 传送，分组以等于该链路最大传输速率的速度传输通过通信链路。

#### 存储转发传输

多数分组交换机在链路的输入端使用**存储转发传输**机制。

> **存储转发传输（`store-and-forward transmission`）**：交换机能够向输出链路传输该分组的第一个比特前，必须接收到整个分组

#### 优势

* 线路利用率更高
* 支持优先级传输
* 可靠性高
* 可以实现不同类型的数据终端设置

#### 劣势

* 存在时延问题
* 分组必须携带一些控制信息需要额外的开销

#### 节点时延

##### **处理时延(`nodal processing delay`)**
> 交换机、路由器等网络设备在收到报文后要进行解封装分析首部、提取数据、差错检验、路由选择等处理，此类时间被称为**节点处理时延**。一般来说，高速路由器的处理时延通常是微秒或者更低的数量级。

##### **排队时延（`queuing delay`）**
> 路由器或交换机等网络设备处理数据包排队所消耗的时间被称为**排队时延**。

###### **排队时延的决定因素**

1. **R** 链路的带宽(bps)
2. **L** 数据包的大小(bits)
3. **a** 数据包的平均到达时长

###### **流量强度与排队时延**
> 假定所有分组都是L比特组成，且队列无限大，则称 La/R 为**流量强度 (traffic intensity)**

1. La/R ~ 0：近乎为0
2. La/R -> 1：慢慢增大
3. La/R > 1：时延将会无穷大

因此：**设计系统时流量强度不能大于1**

###### **丢包（`packet loss`）**

实际情况下输出队列容量是有限的，当分组到达时，队列是满的，路由器将会**丢弃（`drop`）** 该分组。


##### **传输时延（`transmission delay`）**

> 路由器、交换机等网络设备将所有分组的比特推向链路所需要的时间被称为**传输时延**。

如果用 L 比特表示分组的长度，用 R bps(b/s) 表示从路由器A到路由器B的链路传输速率，传输时延是 L/R 。

即：
$$
d_{trans} = \frac{L}{R}
$$

##### **传播时延（`propagation delay`）**

> 报文在实际的物理链路上传播数据所需要的时间被称为**传播时延**。

如果 d 是路由器 A 到路由器 B 之间的距离，s 是该链路之间的传播速率（传播速率取决于链路的物理媒体），传播时延是 d/s 。

即：
$$
d_{prop} = \frac{d}{s}
$$

##### **节点的总时延（`total nodal delay`）**
**节点的总时延** 为处理时延、排队时延、传输时延和传播时延的和，即：
$$
d_{nodal} = d_{proc} + d_{queue} + d_{trans} + d_{prop}
$$


#### 端到端时延

通过由 N 条速率均为 R 的链路组成的路径，此时在源和目的地之间有 N - 1 台路由器，从源到目的地发送一个长度为L的分组，因为[存储转发传输](#存储转发传输)机制，假设网络此时是无拥塞的，那么端到端时延是：

$$
d_{end-end} = N(d_{proc} + \frac{L}{R} + d_{prop}) 
$$
或:
$$
d_{end-end} = N(d_{proc} + d_{trans} + d_{prop})
$$

#### Traceroute

> **traceroute命令用于追踪数据包在网络上的传输时的全部路径**

```bash
traceroute -m 10 www.baidu.com

traceroute to www.baidu.com (183.232.231.172), 10 hops max, 60 byte packets
 1  _gateway (10.0.2.2)  0.321 ms  0.249 ms  0.106 ms
 2  * * *
 3  * * *
 4  * * *
 5  * * *
 6  * * *
 7  * * *
 8  * * *
 9  * * *
10  * * *
```

## 四、性能指标

互联网主要的性能指标有**速率**、**带宽**、**吞吐量**和[时延](#节点时延)等。

### 速率

> **速率（传输速率，`transmission rate`）** 是指计算机网络中的主机在数字信道上，单位时间内从一端传送到另一端的数据量，即数据传输率，也称数据率或比特率，单位为比特/秒（bit/s, bps）

不同的链路拥有不同的传输速率，一般讨论传输速率，往往指的是额定速率或标称速率（理想速率），此指标和物理媒体密切相关。

### 带宽

> **带宽（`bandwidth`）**  是指 计算机网络中的主机在数字信道上，单位时间内从一端传送到另一端的最大数据量，即最大速率

#### 上行带宽与下行带宽

> **上行带宽**是指用户电脑向网络发送信息时的数据传输速率，**下行带宽**是指网络向用户电脑发送信息时的传输速率

### 吞吐量

> **吞吐量（`throughput`）** 是指单位时间内某个信道/端口实际的数据量，可以理解为实际的带宽

**吞吐量等于瓶颈链路的传输速率**，对于n条链路，链路速率分别为R1、R2 ... Rn，吞吐量为：**min{R1, R2 ... Rn}**


#### 瞬时吞吐量和平均吞吐量

> 从服务器到客户机通过计算机网络传送一个大文件，任意时刻客户机接收该文件的速率叫做**瞬时吞吐量（`instantaneous throughput`）**，假设客户机接收该文件的所有 F 比特用了 T 秒，那么 F/T 就叫做**平均吞吐量（`average throughput`）**


## 五、 计算机网络体系结构
### 协议分层

> 网络设计者以 **分层（`layer`）** 的形式组织 **协议（`protocol`）** 以及实现这些协议的网络硬件和软件，各层的所有协议被称为**协议栈（`protocol stack`）**

#### 优点

* 各层之间是独立的，某一层不需要知道其下层实现
* 灵活性好
* 结构上可分割开
* 易于实现和维护
* 能促进标准化工作

#### 潜在缺点

* 一层可能冗余较低层的功能
* 某层功能可能需要仅在其他某层才出现的信息（如时间戳值），这违反了层次分离的目标



现在比较常见的一共有三种协议分层模型，分别为**五层协议模型（因特网协议栈）**、**TCP/IP 模型**、**OSI 分层模型**。

![协议分层](https://gitee.com/huanghuang927/picture-host/raw/master/20211027205459.png)



#### 因特网协议栈

因特网协议栈由**[应用层](应用层.md)（`application layer`)**、**运输层（`transport layer`）**、**网络层（`internet layer`）**、**链路层（`link layer`）**、**物理层 （`physical layer`）** 7 个层次组成。



#### OSI 模型

OSI 模型由**应用层（`application layer`)**、**表示层（`presentation layer`）**、 **会话层（`session layer`）**、**运输层（`transport layer`）**、**网络层（`internet layer`）**、**链路层（`link layer`）**、**物理层 （`physical layer`）** 5 个层次组成。



#### TCP/IP 模型

TCP/IP 模型由**应用层（`application layer`)**、**运输层（`transport layer`）**、**网际层（`internet layer`）**、**链路层（`link layer`）**、**网络接口层 （`network access layer`）** 5 个层次组成。



## 参考资料

- Kurose, J. F., & Ross, K. W. (2018). *计算机网络-自顶而下方法* (7th ed.). 机械工业出版社.
- [Wikipedia : Internet_protocol_suite](https://en.wikipedia.org/wiki/Internet_protocol_suite)
- [Wikipedia : OSI](https://en.wikipedia.org/wiki/OSI_model)
